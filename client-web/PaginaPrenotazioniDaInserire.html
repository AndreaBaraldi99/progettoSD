<!DOCTYPE html>
<html>
<head>
  <title>Prenotazione posti al cinema</title>
  <style>
    .seat-map {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
      gap: 5px;
      max-width: 500px;
      margin: 0 auto;
    }
    .seat {
      width: 50px;
      height: 50px;
      background-color: lightgray;
      cursor: pointer;
    }
    .selected {
      background-color: yellow;
    }
    .disabled {
      background-color: gray;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <h1>Sala cinematografica</h1>
  <div id="seat-map"></div>
  <button id="book-btn">Prenota</button>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      // Matrice di esempio per la disposizione dei posti
      var seatMap = [
        [1, 1, 1, 0, 0, 0, 1],
        [1, 1, 1, 1, 0, 0, 0],
        [0, 0, 1, 0, 0, 1, 1],
        [0, 0, 0, 1, 1, 1, 1],
        [1, 0, 0, 0, 1, 1, 1]
      ];

      // Crea la disposizione dei posti sulla pagina HTML
      var seatMapElement = document.getElementById('seat-map');
      seatMap.forEach((row, rowIndex) => {
        row.forEach((seat, columnIndex) => {
          var seatElement = document.createElement('div');
          seatElement.classList.add('seat');
          seatElement.dataset.row = rowIndex;
          seatElement.dataset.column = columnIndex;
          if (seat === 0) {
            seatElement.classList.add('disabled');
          }
          seatMapElement.appendChild(seatElement);
        });
      });

      // Gestisci il clic sui posti
      var seats = document.querySelectorAll('.seat:not(.disabled)');
      var selectedSeats = [];

      seats.forEach(seat => {
        seat.addEventListener('click', function() {
          this.classList.toggle('selected');

          var row = parseInt(this.dataset.row);
          var column = parseInt(this.dataset.column);

          var seatIndex = selectedSeats.findIndex(s => s.row === row && s.column === column);

          if (seatIndex !== -1) {
            selectedSeats.splice(seatIndex, 1);
          } else {
            selectedSeats.push({ row: row, column: column });
          }
        });
      });

      // Gestisci il clic sul pulsante "Prenota"
      var bookBtn = document.getElementById('book-btn');
      bookBtn.addEventListener('click', function() {
        // Esegui una richiesta POST al server per inviare i posti prenotati
        fetch('prenota_posti.php', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ seats: selectedSeats })
        })
          .then(response => response.json())
          .then(data => {
            console.log(data); // Gestisci la risposta del server
          });
      });
    });
  </script>
</body>
</html>
