<!DOCTYPE html>
<html>
    <head>
        <title>Homepage Cinema</title>
        <link rel="stylesheet" href="styles.css">
        <h1 style="text-align:center">Cinema X</h1>
        <hr class="rounded">
        <h2 style="text-align:center">Programmazione</h2>
        <h3>Seleziona un giorno della settimana:</h3>
    </head>
    
    <body>
        <div id="daysContainer">
            <button onclick="showTable(0)">Lunedì</button>
            <button onclick="showTable(1)">Martedì</button>
            <button onclick="showTable(2)">Mercoledì</button>
            <button onclick="showTable(3)">Giovedì</button>
            <button onclick="showTable(4)">Venerdì</button>
            <button onclick="showTable(5)">Sabato</button>
            <button onclick="showTable(6)">Domenica</button>
        </div>
        <br><br>
        <div id="tableContainer" style="display: none;">
            <h4 id="dayTitle"></h4>
            <table id="dayTable">
            <!-- Contenuto della tabella verrà generato dinamicamente -->
            </table>
        </div>
    
        <script>
            async function fetchAsync () {
                const response = await fetch("http://localhost:8080/movies");
                if (!response.ok)
                    throw new Error(`Response was not successful: ${response.status} ${response.statusText}`);
                const data = await response.json();
                return data;
            }          

            var dayTables = [
                [
                    ["Lunedì, Riga 1, Colonna 1", "Lunedì, Riga 1, Colonna 2", "Lunedì, Riga 1, Colonna 3", "Lunedì, Riga 1, Colonna 4", "Lunedì, Riga 1, Colonna 5"],
                    ["Lunedì, Riga 2, Colonna 1", "Lunedì, Riga 2, Colonna 2", "Lunedì, Riga 2, Colonna 3", "Lunedì, Riga 2, Colonna 4", "Lunedì, Riga 2, Colonna 5"],
                    ["Lunedì, Riga 3, Colonna 1", "Lunedì, Riga 3, Colonna 2", "Lunedì, Riga 3, Colonna 3", "Lunedì, Riga 3, Colonna 4", "Lunedì, Riga 3, Colonna 5"]
                ],
                [
                    ["Martedì, Riga 1, Colonna 1", "Martedì, Riga 1, Colonna 2", "Martedì, Riga 1, Colonna 3", "Martedì, Riga 1, Colonna 4", "Martedì, Riga 1, Colonna 5"],
                    ["Martedì, Riga 2, Colonna 1", "Martedì, Riga 2, Colonna 2", "Martedì, Riga 2, Colonna 3", "Martedì, Riga 2, Colonna 4", "Martedì, Riga 2, Colonna 5"],
                    ["Martedì, Riga 3, Colonna 1", "Martedì, Riga 3, Colonna 2", "Martedì, Riga 3, Colonna 3", "Martedì, Riga 3, Colonna 4", "Martedì, Riga 3, Colonna 5"]
                ],
                [
                    ["Mercoledì, Riga 1, Colonna 1", "Mercoledì, Riga 1, Colonna 2", "Mercoledì, Riga 1, Colonna 3", "Mercoledì, Riga 1, Colonna 4", "Mercoledì, Riga 1, Colonna 5"],
                    ["Mercoledì, Riga 2, Colonna 1", "Mercoledì, Riga 2, Colonna 2", "Mercoledì, Riga 2, Colonna 3", "Mercoledì, Riga 2, Colonna 4", "Mercoledì, Riga 2, Colonna 5"],
                    ["Mercoledì, Riga 3, Colonna 1", "Mercoledì, Riga 3, Colonna 2", "Mercoledì, Riga 3, Colonna 3", "Mercoledì, Riga 3, Colonna 4", "Mercoledì, Riga 3, Colonna 5"]
                ],
                [
                    ["Giovedì, Riga 1, Colonna 1", "Giovedì, Riga 1, Colonna 2", "Giovedì, Riga 1, Colonna 3", "Giovedì, Riga 1, Colonna 4", "Giovedì, Riga 1, Colonna 5"],
                    ["Giovedì, Riga 2, Colonna 1", "Giovedì, Riga 2, Colonna 2", "Giovedì, Riga 2, Colonna 3", "Giovedì, Riga 2, Colonna 4", "Giovedì, Riga 2, Colonna 5"],
                    ["Giovedì, Riga 3, Colonna 1", "Giovedì, Riga 3, Colonna 2", "Giovedì, Riga 3, Colonna 3", "Giovedì, Riga 3, Colonna 4", "Giovedì, Riga 3, Colonna 5"]
                ],
                [
                    ["Venerdì, Riga 1, Colonna 1", "Venerdì, Riga 1, Colonna 2", "Venerdì, Riga 1, Colonna 3", "Venerdì, Riga 1, Colonna 4", "Venerdì, Riga 1, Colonna 5"],
                    ["Venerdì, Riga 2, Colonna 1", "Venerdì, Riga 2, Colonna 2", "Venerdì, Riga 2, Colonna 3", "Venerdì, Riga 2, Colonna 4", "Venerdì, Riga 2, Colonna 5"],
                    ["Venerdì, Riga 3, Colonna 1", "Venerdì, Riga 3, Colonna 2", "Venerdì, Riga 3, Colonna 3", "Venerdì, Riga 3, Colonna 4", "Venerdì, Riga 3, Colonna 5"]
                ],
                [
                    ["Sabato, Riga 1, Colonna 1", "Sabato, Riga 1, Colonna 2", "Sabato, Riga 1, Colonna 3", "Sabato, Riga 1, Colonna 4", "Sabato, Riga 1, Colonna 5"],
                    ["Sabato, Riga 2, Colonna 1", "Sabato, Riga 2, Colonna 2", "Sabato, Riga 2, Colonna 3", "Sabato, Riga 2, Colonna 4", "Sabato, Riga 2, Colonna 5"],
                    ["Sabato, Riga 3, Colonna 1", "Sabato, Riga 3, Colonna 2", "Sabato, Riga 3, Colonna 3", "Sabato, Riga 3, Colonna 4", "Sabato, Riga 3, Colonna 5"]
                ],
                [
                    ["Domenica, Riga 1, Colonna 1", "Domenica, Riga 1, Colonna 2", "Domenica, Riga 1, Colonna 3", "Domenica, Riga 1, Colonna 4", "Domenica, Riga 1, Colonna 5"],
                    ["Domenica, Riga 2, Colonna 1", "Domenica, Riga 2, Colonna 2", "Domenica, Riga 2, Colonna 3", "Domenica, Riga 2, Colonna 4", "Domenica, Riga 2, Colonna 5"],
                    ["Domenica, Riga 3, Colonna 1", "Domenica, Riga 3, Colonna 2", "Domenica, Riga 3, Colonna 3", "Domenica, Riga 3, Colonna 4", "Domenica, Riga 3, Colonna 5"]
                ]
            ];
           
            
            async function showTable(dayIndex) {
                var daysContainer = document.getElementById("daysContainer");
                var tableContainer = document.getElementById("tableContainer");
                var dayTitle = document.getElementById("dayTitle");
                var dayTable = document.getElementById("dayTable");
                var buttons = daysContainer.getElementsByTagName("button");
    
                // Rimuovi la classe 'active' da tutti i pulsanti
                for (var i = 0; i < buttons.length; i++) {
                    buttons[i].classList.remove("active");
                }
    
                // Aggiungi la classe 'active' al pulsante selezionato
                buttons[dayIndex].classList.add("active");
    
                // Imposta il titolo del giorno corrispondente
                dayTitle.innerHTML = buttons[dayIndex].innerHTML;
    
                // Genera la tabella con il contenuto corrispondente al giorno
                var tableContent = dayTables[dayIndex]; 
                var data = await fetchAsync();
                //PROBLEMA GRANDE DA RISOLVERE QUI **Risolto** :) 
                var tableHTML = "";
                tableHTML += "<tr>";
                for(let x in data[0][0]){
                    if(x == "seatsGrid") continue;
                    tableHTML += "<th>" + x + "</th>";
                }
                tableHTML += "</tr>";
                for(let i = 0; i < data[dayIndex].length; i++){
                    tableHTML += "<tr>";
                    for(let x in data[dayIndex][i]){
                        if(x == "seatsGrid") continue;
                        tableHTML += "<td>" + data[dayIndex][i][x] + "</td>";
                    }
                    tableHTML += "</tr>";
                }

                /*  for (var i = 0; i < tableContent.length; i++) {
                    tableHTML += "<tr>";
                    for (var j = 0; j < tableContent[i].length; j++) {
                        tableHTML += "<td>" + tableContent[i][j] + "</td>";
                    }
                    tableHTML += "</tr>";
                } */
                dayTable.innerHTML = tableHTML;
    
                tableContainer.style.display = "block";
            }
                    
        </script>

    </body>
</html>